<?xml version="1.0"?>
<launch>
    <arg name="map" default="map"/>
    <!--arg name="map" default="cave"/-->
    <arg name="local_planner" default="true"/>
    <arg name="reinitialize" default="false"/>

    <arg name="robot_name" default="r0" />
    <arg name="scan" default="laser0/scan" />
    <arg name="cfg" default="01" />

    <group ns="$(arg robot_name)">
        <!-- Map server just as reference -->
        <node name="map_server" pkg="map_server" type="map_server" args="$(find mr_launch)/cfg/map_server/$(arg map)/$(arg map).yaml">
            <!--remap from="map" to="map_ref" -->
        </node>

        <!-- RViz with configuration to show useful topics -->
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find mr_launch)/rviz/goto1.rviz" />  
  
    <node pkg="amcl" type="amcl" name="amcl" output="screen">
      <remap from="scan" to="$(arg scan)"/>   
      <remap from="map" to="/$(arg robot_name)/map"/>
      <remap from="initialpose" to="/$(arg robot_name)/initialpose"/>
      <remap from="static_map" to="/static_map"/>     
      <rosparam file="$(find mr_launch)/cfg/amcl/$(arg cfg)/amcl_filter.yaml" command="load"/>
      <rosparam file="$(find mr_launch)/cfg/amcl/$(arg cfg)/amcl_laser_model.yaml" command="load"/>
      <rosparam file="$(find mr_launch)/cfg/amcl/$(arg cfg)/amcl_motion_model.yaml" command="load"/>
      <param name="odom_frame_id" value="$(arg robot_name)/odom"/>    
      <param name="base_frame_id" value="$(arg robot_name)/base_link"/>  
      <param name="global_frame_id" value="map"/>      
      <param name="use_map_topic" value="true"/>      
    </node>

    <node pkg="mr_local_planner" type="global_planner.py" name="global_planner" output="screen">
        <remap from="/pose" to="/$(arg robot_name)/initialpose" />
        <remap from="/goal" to="/move_base_simple/goal" />
        <remap from="/map" to="/$(arg robot_name)/map" />
        <!--remap from="pose" to="pose_estimated" /-->
    </node>

    <node pkg="mr_local_planner" type="mr_local_planner_node" name="local_planner" output="screen">
        <param name="mode" value="7" />
        <param name="plot_data" value="false" />
        <remap from="scan" to="$(arg scan)" />
        <remap from="cmd_vel" to="/r0/cmd_vel" />
        <remap from="odom" to="/r0/aria/odom" />
        <remap from="/goal" to="/move_base_simple/goal" />
        <remap from="/$(arg robot_name)/waypoints" to="/waypoints" />
    </node>

    </group>


</launch>


